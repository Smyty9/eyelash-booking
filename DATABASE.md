# Описание базы данных

Документация по структуре таблиц и моделям Prisma.

## Модели данных

### User (users)

Пользователи системы: администраторы и клиенты.

| Поле | Тип | Описание |
|------|-----|----------|
| `id` | String (UUID) | Уникальный идентификатор пользователя |
| `phone` | String | Номер телефона (уникальный) |
| `name` | String? | Имя пользователя (опционально) |
| `role` | UserRole | Роль пользователя (ADMIN или CLIENT), по умолчанию CLIENT |
| `createdAt` | DateTime | Дата создания записи |
| `appointments` | Appointment[] | Связь с записями на прием |

**Индексы:**
- Уникальный индекс на `phone`

**Связи:**
- Один ко многим с `Appointment` (один пользователь может иметь множество записей)

---

### Service (services)

Услуги по наращиванию ресниц.

| Поле | Тип | Описание |
|------|-----|----------|
| `id` | String (UUID) | Уникальный идентификатор услуги |
| `name` | String | Название услуги |
| `description` | String? | Описание услуги (опционально) |
| `price` | Float | Цена услуги |
| `durationMinutes` | Int | Длительность услуги в минутах |
| `isActive` | Boolean | Активна ли услуга (по умолчанию true) |
| `createdAt` | DateTime | Дата создания записи |
| `updatedAt` | DateTime | Дата последнего обновления |
| `appointments` | Appointment[] | Связь с записями на прием |

**Связи:**
- Один ко многим с `Appointment` (одна услуга может быть выбрана в множестве записей)

---

### Appointment (appointments)

Записи клиентов на прием.

| Поле | Тип | Описание |
|------|-----|----------|
| `id` | String (UUID) | Уникальный идентификатор записи |
| `date` | DateTime | Дата и время приема |
| `status` | AppointmentStatus | Статус записи (PENDING, CONFIRMED, CANCELED), по умолчанию PENDING |
| `userId` | String | ID пользователя (внешний ключ) |
| `serviceId` | String | ID услуги (внешний ключ) |
| `createdAt` | DateTime | Дата создания записи |
| `updatedAt` | DateTime | Дата последнего обновления |
| `user` | User | Связь с пользователем |
| `service` | Service | Связь с услугой |

**Индексы:**
- Индекс на `date` (для быстрого поиска по дате)
- Индекс на `userId` (для быстрого поиска записей пользователя)
- Индекс на `serviceId` (для быстрого поиска записей по услуге)

**Связи:**
- Многие к одному с `User` (каждая запись принадлежит одному пользователю, каскадное удаление)
- Многие к одному с `Service` (каждая запись связана с одной услугой, каскадное удаление)

---

## Перечисления (Enums)

### UserRole

Роли пользователей в системе.

- `ADMIN` - Администратор (доступ к админ-панели)
- `CLIENT` - Клиент (доступ только к публичной части)

---

### AppointmentStatus

Статусы записи на прием.

- `PENDING` - Ожидает подтверждения (по умолчанию)
- `CONFIRMED` - Подтверждена
- `CANCELED` - Отменена

---

## Диаграмма связей

```
User (1) ────────< (N) Appointment (N) >─────── (1) Service
```

- Один пользователь может иметь множество записей
- Одна услуга может быть выбрана в множестве записей
- Каждая запись принадлежит одному пользователю и одной услуге

---

## Примечания

- Все ID используют UUID формат
- При удалении пользователя или услуги, связанные записи удаляются каскадно (`onDelete: Cascade`)
- Таблицы в БД используют snake_case имена (`users`, `services`, `appointments`), определенные через `@@map()`

